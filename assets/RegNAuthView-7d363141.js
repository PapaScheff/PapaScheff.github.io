import{_ as B,r as n,o as d,c as p,a as q,u as H,b as J,d as K,s as C,e as M,f as t,t as o,g as $,h as s,w as c,i as E,F as O,j as F}from"./index-fda26685.js";const Q=["type","required","title","pattern","placeholder"],X={__name:"useInput",props:{placeholder:String,type:String,isDate:Boolean,pattern:String,title:String,required:Boolean},setup(l,{expose:u}){const i=n(null);return u({input:i}),(m,r)=>(d(),p("input",{type:l.type,required:l.required,title:l.title,pattern:l.pattern,onBlur:r[0]||(r[0]=y=>l.isDate?l.type="text":l.type=l.type),onFocus:r[1]||(r[1]=y=>l.isDate?l.type="date":l.type=l.type),ref_key:"input",ref:i,placeholder:l.placeholder},null,40,Q))}},v=B(X,[["__scopeId","data-v-bb00bda8"]]);const Y=["value","placeholder","disabled"],Z={__name:"useButton",props:{value:String,height:String,width:String,disabled:Boolean,placeholder:String},setup(l){const u=l,i=n(null);return q(()=>{i.value.style.width=`${Number(u.width)}px`,i.value.style.height=`${Number(u.height)}px`}),(m,r)=>(d(),p("input",{value:l.value,type:"submit",placeholder:l.placeholder,ref_key:"button",ref:i,disabled:l.disabled},null,8,Y))}},N=B(Z,[["__scopeId","data-v-d5685bad"]]);const x={key:0,class:"step s0"},ee={key:1,class:"step s1"},te={action:""},le={class:"controls"},ae={key:2,class:"step s2"},se={action:""},ne={class:"input"},oe={class:"input"},ie={class:"controls"},ue={key:3,class:"auth"},re={action:""},ce={class:"controls"},de={__name:"RegNAuthView",setup(l){const u=H(),{locale:i,t:m}=J({}),r=K();q(()=>{localStorage.getItem("locale")?(i.value=localStorage.getItem("locale"),r.value=m("titles.place")):(i.value=navigator.language.slice(0,2),r.value=m("titles.place"),localStorage.setItem("locale",i.value))});const y=n(!0),g=n(!1),k=n(!1),w=n(!1),S=n(null),I=n(null),A=n(null),L=n(null),T=n(null),V=n(null),b=n(null),h=n(null);q(()=>{U().then(e=>{e.session!=null?u.push("mobile"):setTimeout(()=>{y.value=!1,g.value=!0},3e3)})});async function U(){const{data:e,error:a}=await C.auth.getSession();return e}function j(){w.value=!1,g.value=!0}function R(){w.value=!0,g.value=!1,k.value=!1}function P(){S.value.input.value.length!=0&&I.value.input.value.length!=0&&(localStorage.setItem("name",S.value.input.value),localStorage.setItem("bday",I.value.input.value),g.value=!1,k.value=!0)}function W(e,a){return Math.floor(Math.random()*(a-e+1)+e)}async function z(){const{data:e,error:a}=await C.auth.signUp({email:A.value.input.value,password:T.value.input.value,options:{data:{name:localStorage.getItem("name"),bday:localStorage.getItem("bday"),language:localStorage.getItem("locale"),profileImageNumber:W(1,10)}}});e.user!=null?(u.push("mobile"),localStorage.removeItem("name"),localStorage.removeItem("bday")):a=="AuthApiError: User already registered"&&(b.value.textContent=m("mobile.errors.user_exist"),setTimeout(()=>{b.value.classList.add("anim")},5e3),setTimeout(()=>{b.value.classList.add("hide"),b.value.classList.remove("anim")},6e3))}async function G(){const{data:e,error:a}=await C.auth.signInWithPassword({email:L.value.input.value,password:V.value.input.value});e.user!=null?u.push("mobile"):(h.value.classList.remove("hide"),a=="AuthApiError: Invalid login credentials"&&(h.value.textContent=m("mobile.errors.invalid_login"),setTimeout(()=>{h.value.classList.add("anim")},5e3),setTimeout(()=>{h.value.classList.add("hide"),h.value.classList.remove("anim")},6e3)))}return(e,a)=>{const D=M("router-link"),f=M("i18n-t");return d(),p(O,null,[y.value?(d(),p("section",x,[t("p",null,o(e.$t("mobile.hello")),1)])):$("",!0),g.value?(d(),p("section",ee,[t("h1",null,o(e.$t("mobile.letsmeet")),1),t("form",te,[s(v,{placeholder:e.$t("mobile.inputs.placeholders.name"),ref_key:"name",ref:S,type:"text",required:""},null,8,["placeholder"]),s(v,{placeholder:e.$t("mobile.inputs.placeholders.bday"),ref_key:"bday",ref:I,type:"text",isDate:"",required:""},null,8,["placeholder"]),t("div",le,[s(N,{value:e.$t("mobile.inputs.buttons.next"),onClick:a[0]||(a[0]=_=>P()),width:"222",height:"54"},null,8,["value"]),t("section",null,[s(f,{keypath:"mobile.misc.agreement.1",tag:"p",scope:"global"},{default:c(()=>[s(D,{to:"/terms"},{default:c(()=>[F(o(e.$t("mobile.misc.agreement.2")),1)]),_:1})]),_:1}),s(f,{keypath:"mobile.misc.account.1",tag:"p",scope:"global"},{default:c(()=>[t("span",{onClick:a[1]||(a[1]=_=>R())},o(e.$t("mobile.misc.account.2")),1)]),_:1})])])])])):$("",!0),k.value?(d(),p("section",ae,[t("h1",null,o(e.$t("mobile.few_more")),1),t("form",se,[t("div",ne,[s(v,{placeholder:e.$t("mobile.inputs.placeholders.email"),ref_key:"email_reg",ref:A,type:"email",required:""},null,8,["placeholder"]),t("span",null,o(e.$t("mobile.inputs.hints.mail")),1)]),t("div",oe,[s(v,{placeholder:e.$t("mobile.inputs.placeholders.password"),ref_key:"pass_reg",ref:T,type:"password",required:""},null,8,["placeholder"]),t("span",null,o(e.$t("mobile.inputs.hints.mail")),1),t("span",{class:"error",ref_key:"error_span_reg",ref:b},null,512)]),t("div",ie,[s(N,{value:e.$t("mobile.inputs.buttons.complete"),onClick:a[2]||(a[2]=E(_=>z(),["prevent"])),width:"222",height:"54"},null,8,["value"]),t("section",null,[s(f,{keypath:"mobile.misc.agreement.1",tag:"p",scope:"global"},{default:c(()=>[s(D,{to:"/terms"},{default:c(()=>[F(o(e.$t("mobile.misc.agreement.2")),1)]),_:1})]),_:1}),s(f,{keypath:"mobile.misc.account.1",tag:"p",scope:"global"},{default:c(()=>[t("span",{onClick:a[3]||(a[3]=_=>R())},o(e.$t("mobile.misc.account.2")),1)]),_:1})])])])])):$("",!0),w.value?(d(),p("section",ue,[t("h1",null,o(e.$t("mobile.auth")),1),t("form",re,[s(v,{placeholder:e.$t("mobile.inputs.placeholders.email"),ref_key:"email_auth",ref:L,type:"email",required:""},null,8,["placeholder"]),s(v,{placeholder:e.$t("mobile.inputs.placeholders.password"),ref_key:"pass_auth",ref:V,type:"password",required:""},null,8,["placeholder"]),t("span",{class:"error",ref_key:"error_span_auth",ref:h},null,512),t("div",ce,[s(N,{value:e.$t("mobile.inputs.buttons.signin"),onClick:a[4]||(a[4]=E(_=>G(),["prevent"])),width:"222",height:"54"},null,8,["value"]),t("section",null,[s(f,{keypath:"mobile.misc.account.3",scope:"global",tag:"p"},{default:c(()=>[t("span",{onClick:a[5]||(a[5]=_=>j())},o(e.$t("mobile.misc.account.4")),1)]),_:1})])])])])):$("",!0)],64)}}},me=B(de,[["__scopeId","data-v-6badf09c"]]);export{me as default};
